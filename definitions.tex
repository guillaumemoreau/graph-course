% Définitions pour commencer

\begin{frame}{Graphe}
    \begin{definition}
        Un \emph{graphe orienté} est un ensemble de \emph{sommets} connectés par des emph{arcs}. Formellement, $G=(S,A)$ avec
        \begin{itemize}
            \item $S$ un ensemble de sommets 
            \item $A$ une relation binaire sur $S$ (donc une partie de $S \times S$)
        \end{itemize}
    \end{definition}

    \begin{example}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \node (s) at (6,0) {6 sommets, 7 arcs};
            \draw[edge] (1) -> (4);
            \draw[edge] (1) -> (2) -> (4);
            \draw[edge] (2) -> (3);
            \draw[edge] (6) -> (5);
            \draw[edge] (4.260) -> (3.100);
            \draw[edge] (3.800) -> (4.280);
        \end{tikzpicture}
    \end{example}
\end{frame}

\begin{frame}{Graphe}
    \begin{definition}
        Un \emph{graphe non orienté} est un ensemble de \emph{sommets} connectés par des emph{arêtes}. Formellement, $G=(S,A)$ avec
        \begin{itemize}
            \item $S$ un ensemble de sommets 
            \item $A$ un ensemble de paires non-ordonnées de sommets
        \end{itemize}
    \end{definition}

    \begin{example}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \node (s) at (6,0) {6 sommets, 6 arêtes};
            \draw (1) -- (4);
            \draw (1) -- (2) -> (4);
            \draw (2) -- (3);
            \draw (6) -- (5);
            \draw (4) -- (3);
        \end{tikzpicture}
    \end{example}
\end{frame}

\begin{frame}{Vocabulaire}
    \begin{definition}
        Dans un graphe $G(S,A)$ orienté ou non, un sommet $y$ est dit \emph{adjacent} à $x$ si et seulement si $(x,y \in A$)
    \end{definition}
    \begin{example}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \draw[edge] (1) -> (4);
            \draw[edge] (1) -> (2) -> (4);
            \draw[edge] (2) -> (3);
            \draw[edge] (6) -> (5);
            \draw[edge] (4.260) -> (3.100);
            \draw[edge] (3.800) -> (4.280);
            \node (l) at (1,-2) {4 et 3 sont adjacents à 2};
        \end{tikzpicture}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \draw (1) -- (4);
            \draw (1) -- (2) -> (4);
            \draw (2) -- (3);
            \draw (6) -- (5);
            \draw (4) -- (3);
            \node (l) at (1,-2) {1, 4 et 3 sont adjacents à 2};
        \end{tikzpicture}

    \end{example}
\end{frame}

\begin{frame}{Vocabulaire}
    \begin{definition}
        Dans un graphe $G=(S,A)$ non orienté, le degré d'un sommet est le nombre de ses sommets adjacents
    \end{definition}
    \begin{example}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \draw (1) -- (4);
            \draw (1) -- (2) -> (4);
            \draw (2) -- (3);
            \draw (6) -- (5);
            \draw (4) -- (3);
            \node (l) at (6,0) {le sommet 3 est de degré 2};
            \node (ll) at (6,-1) {le sommet 3 est de degré 2};
        \end{tikzpicture}
    \end{example}
\end{frame}

\begin{frame}{Vocabulaire} 
    \begin{definition}
        Dans un graphe $G=(S,A)$ orienté, 
        \begin{itemize}
            \item le \emph{degré sortant} (ou extérieur) d'un sommet $x$, noté $\Gamma^+(x)$ est le nombre de ses sommets adjacents 
            \item le \emph{degré entrant} (ou intérieur) d'un sommet $x$, noté $\Gamma^-(x)$ est le nombre des sommets auxquels il est adjacent
        \end{itemize}
    \end{definition}
    \begin{example}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \draw[edge] (1) -> (4);
            \draw[edge] (1) -> (2) -> (4);
            \draw[edge] (2) -> (3);
            \draw[edge] (6) -> (5);
            \draw[edge] (4.260) -> (3.100);
            \draw[edge] (3.800) -> (4.280);
            \node (l) at (6,0) {le degré entrant de 2 est 1};
            \node (ll) at (6,-1) {le degré sortant de 2 est 2};
        \end{tikzpicture}        
    \end{example}
\end{frame}

\begin{frame}{Vocabulaire}
    \begin{definition}
        Dans un graphe $G=(S,A)$ orienté ou non, un \emph{chemin} est une séquence de sommets $s_0,...s_n$ où chaque paire de sommets consécutifs $(s_k,s_{k+1})$ appartient à $a$. 
    \end{definition}
    \begin{example}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \draw[oeedge] (1) -> (4);
            \draw[edge] (1) -> (2) -> (4);
            \draw[edge] (2) -> (3);
            \draw[edge] (6) -> (5);
            \draw[oeedge] (4.260) -> (3.100);
            \draw[edge] (3.800) -> (4.280);
            \node (l) at (1,-2) {$(1,4,3)$ est un chemin};
        \end{tikzpicture}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6}; 
            \draw[eedge] (1) -- (4);
            \draw (1) -- (2);
            \draw (2) -- (4);
            \draw[eedge] (2) -- (3);
            \draw (6) -- (5);
            \draw[eedge] (4) -- (3);
            \node (l) at (1,-2) {$(1,2,3,4)$ est un chemin};
        \end{tikzpicture}
    \end{example}
\end{frame}

\begin{frame}{Vocabulaire}
    \begin{definition}
        Dans un graphe $G=(S,A)$ orienté ou non, un chemin \emph{simple} est un chemin sans répétition de sommets
    \end{definition}
    \begin{definition}
        Dans un graphe $G=(S,A)$ orienté ou non, un \emph{cycle} est un chemin $(s_0,...s_n)$ où $s_0 = s_n$ et $s_0,...s_{n-1}$ sont distincts
    \end{definition}
\end{frame}

% connexité



\begin{frame}{Vocabulaire}
    \begin{definition}
        Un graphe $G=(S,A)$ \textbf{non orienté} est \emph{connexe} si et seulement si toute paire de sommets est reliée par au moins un chemin
    \end{definition}
    \begin{center}
        \includegraphics<1>[width=.49\textwidth]{fig/connexe.pdf}
        \includegraphics<2>[width=.49\textwidth]{fig/pasconnexe.pdf}
        \includegraphics<3>[width=.49\textwidth]{fig/pasconnexe2.pdf}
    \end{center}
    \visible<3>{Un graphe peut toujours être décomposé en une union disjointe de sous-graphes connexes : ses \emph{composantes connexes}.}
\end{frame}

\begin{frame}{Vocabulaire}
    \begin{definition}
        Un graphe $G=(S,A)$ \textbf{orienté} est \emph{fortement connexe} si et seulement si toute paire de sommets est reliée par au moins un chemin, c'est-à-dire si $\forall x,y \in S$ il existe un chemin de $x$ à $y$ \textbf{et} un chemin de $y$ à $x$
    \end{definition}
    \begin{block}{Propriété}
        La connectivité forte est une relation d'équivalence :

        \begin{itemize}
            \item elle est réflexive, symétrique et transitive 
            \item ses classes d'équivalences sont les composantes fortement connexes du graphe 
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Arbres}
    \begin{definition}
        Un \emph{arbre} est un graphe non-orienté connexe et acyclique (ne contient pas de cycle)
    \end{definition}
    \begin{example}
        \begin{center}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6};
            \draw (1) -- (2);     
            \draw (2) -- (4);
            \draw (2) -- (3);
            \draw (3) -- (6);
            \draw (6) -- (5);     
        \end{tikzpicture}\hspace{1cm}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6};
            \draw (1) -- (2);     
            \draw (2) -- (4);
            \draw (2) -- (3);
            \draw (3) -- (6);
            \draw (6) -- (5);  
            \draw (3) -- (4);    
        \end{tikzpicture}\hspace{1cm}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6};
            \draw (1) -- (2);     
            \draw (2) -- (4);
            \draw (2) -- (3);
            \draw (6) -- (5);  
        \end{tikzpicture}
    \end{center}

    \end{example}
\end{frame}

\begin{frame}{Propriétés des arbres}
    \begin{itemize}
        \item Les arbres ont des propriétés fortes qui permettent de simplifier et accélérer certains algorithmes 
        \begin{block}{Propriété}
            Dans un arbre $(S,A)$, $|S| = |A| + 1$
        \end{block}
    \end{itemize}
    \begin{example}
        \begin{center}
            \begin{tikzpicture}
                \node[lettre] (1) at (0,0)  {1};
                \node[lettre] (2) at (0,-1) {2};
                \node[lettre] (3) at (1,-1) {3};
                \node[lettre] (4) at (1,0) {4};
                \node[lettre] (5) at (2,0) {5};
                \node[lettre] (6) at (2,-1) {6};
                \draw (1) -- (2);     
                \draw (2) -- (4);
                \draw (2) -- (3);
                \draw (3) -- (6);
                \draw (6) -- (5);     
            \end{tikzpicture}
        \end{center}            
    \end{example}
\end{frame}

\begin{frame}{Forêts}
    \begin{definition}
        Une \emph{forêt} est un graphe non-orienté acyclique
    \end{definition}
    \begin{example}
        \begin{center}
        \begin{tikzpicture}
            \node[lettre] (1) at (0,0)  {1};
            \node[lettre] (2) at (0,-1) {2};
            \node[lettre] (3) at (1,-1) {3};
            \node[lettre] (4) at (1,0) {4};
            \node[lettre] (5) at (2,0) {5};
            \node[lettre] (6) at (2,-1) {6};
            \draw (1) -- (2);     
            \draw (2) -- (4);
            \draw (2) -- (3);
            \draw (6) -- (5);  
        \end{tikzpicture}
    \end{center}
    \end{example}
    \pause 
    \begin{block}{Propriété}
        Les composantes connexes des forêts sont des arbres
    \end{block}

\end{frame}


\begin{frame}{Fermeture transitive}
    \begin{definition}
        Dans un graphe, orienté ou non, un sommet $y$ est dit \emph{accessible} depuis un sommmet $x$ si et seulement si
        il existe un chemin de $x$ à $y$
    \end{definition}

    \begin{block}{Propriété}
        On peut décider si $y$ est accessible depuis $x$ grâce à un parcours en profondeur depuis $x$ en temps linéaire
    \end{block}

    \begin{definition}
        La \emph{fermeture transitive} d'un graphe $G=(S,A)$ est un graphe $G^*=(S,A^*)$ avec les mêmes sommets mais tel qu'il existe un arc $(x,y) \in A^*$ si et seulement si il existe un chemin de $x$ à $y$ dans $G$
    \end{definition}
\end{frame}

\begin{frame}{Propriétés}
\begin{block}{Propriété}
    La fermeture transitive d'un graphe non orienté connexe (respectivement orienté fortement connexe) est le graphe complet
\end{block}

\begin{block}{Propriété}
    Si on connait $G^*$, la requête d'accessibilité se fait en temps constant
\end{block}
\end{frame}

% TODO remplacer les Adj[i] par $\Gamma(i)$ dans les algos 

\begin{frame}{Calcul de la fermeture transitive dans un graphe \emph{creux}}
\begin{columns}
\begin{column}{0.5\textwidth}
    \begin{algorithmic}
        \Function{visite}{l,i}
        \State $A^*[l,i]$ \gets True 
        \For{$j \in \Gamma(i)$} 
        \If{non $A^*[l,j]$}  
            \State visite(l,j)
        \EndIf
        \EndFor
        \EndFunction
    \end{algorithmic}
\end{column}
\begin{column}{0.5\textwidth}
    \begin{algorithmic}
        \Function{fermeture transitive}{}
            \State $A^*$ = [[False,False],...[False,False]]
            \For{$i \in S$} 
                \State visite(i,i)
            \EndFor \\
        \Return $A^*$
        \EndFunction
    \end{algorithmic}
\end{column}
\end{columns}
\end{frame}

\begin{frame}{Exemple}
\begin{center}
    \input{genfig/ft0}
\end{center}
\end{frame}

\begin{frame}{Exemple : fermeture réflexo-transitive}
\begin{center}
    \input{genfig/ft1}
\end{center}
    \end{frame}

\begin{frame}{Calcul de la fermeture transitive}
\begin{itemize}
    \item La calcul se fait en ${\cal O}(nm)$ avec $n$ parcours en profondeur
    \item En pratique, $A*$ est plutôt dense... On peut faire le calcul de façon matricielle
    \item cf. algorithme de Floyd-Warshall en TD 
\end{itemize}
\end{frame}


% TODO placé là mais à déplacer après le merge 
\input{calcul-cfc.tex}

